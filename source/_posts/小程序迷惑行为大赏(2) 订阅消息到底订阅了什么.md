---
title: 小程序迷惑行为大赏(2) 订阅消息到底订阅了什么
date: 2021-01-17 20:17:31
tags:
---
（讲笑话）
本来第二篇是打算给小程序的分享api相关的，但是订阅消息实在是太搞笑了所以给他加急

一般来说，我们使用app的时候，无论是ios还是安卓，都可以给用户发送系统推送。但是小程序的场景下怎么办呢？小程序提供了订阅服务，允许通过小程序内部的途径给用户发消息。看起来好像很不错？我们看看文档

原文如下：“
订阅消息包括两种：

一次性订阅消息

一次性订阅消息用于解决用户使用小程序后，后续服务环节的通知问题。用户自主订阅后，开发者可不限时间地下发一条对应的服务消息；每条消息可单独订阅或退订。

长期订阅消息

一次性订阅消息可满足小程序的大部分服务场景需求，但线下公共服务领域存在一次性订阅无法满足的场景，如航班延误，需根据航班实时动态来多次发送消息提醒。为便于服务，我们提供了长期性订阅消息，用户订阅一次后，开发者可长期下发多条消息。

目前长期性订阅消息仅向政务民生、医疗、交通、金融、教育等线下公共服务开放，后期将逐步支持到其他线下公共服务业务。
”

看起来好长一段，我们直接总结：长期订阅是人上人小程序，你我不配用。普通用户只能用一次性订阅消息。
在看一次性订阅消息之前我们先看看长期订阅的流程：
1、用户点击触发事件，前端向用户请求订阅
2、若用户同意订阅，则后端可以向用户发送消息；不然，用户的消息无法收到。
看起来是很正常的流程对吧？对，长期订阅是很正常的流程，所以对比之下，一次性订阅就是非常不正常的流程

一次性订阅的流程是这样的：
1、用户点击触发事件，前端向用户请求订阅
2、若用户同意前端弹出的订阅申请，则“为用户的订阅次数计数器+1”
3、若计数器的数量为0，则无法收到后端的消息；若不为0，则可以收到，且每当收到信息的时候使计数器-1

啥意思呢，可以理解为微信给的一次性订阅本质上是一个长期的异步请求。它对用户的某个操作给出一个异步的回应，比如说：用户点击了一次下单，就可以给用户一次到货的回应。这是一次性订阅适合的场景。
不适合的场景是什么呢？几乎所有的其他消息推送的场景，比如用户的集体推送，社区类的点赞回复通知，可以说微信小程序一概不支持。如果您还在为这些功能如何实现而烦心，那大可不必，因为微信小程序根本就不支持。

拓展阅读之一次性订阅消息的解决方案：订阅消息，你懂与不懂，它就在那里
https://developers.weixin.qq.com/community/develop/article/doc/0008802e8381e0eeabb92c9975b013